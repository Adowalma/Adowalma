name: Update GitHub Stats

on:
  schedule:
    - cron: "0 0 * * *" # Executa diariamente
  workflow_dispatch:

jobs:
  generate:
    runs-on: ubuntu-latest

    steps:
      # Checkout do repositório
      - name: Checkout
        uses: actions/checkout@v3

      # Gerar Stats com repositórios privados
      - name: Generate Stats
        env:
          PAT: ${{ secrets.PAT }}
        run: |
          curl -o stats.svg "https://github-readme-stats.vercel.app/api?username=${{ github.repository_owner }}&count_private=true&include_all_commits=true&theme=dracula&token=${{ secrets.PAT }}"

      # Commit e Push dos arquivos gerados
      - name: Push Changes
        env:
          PAT: ${{ secrets.PAT }}
        run: |
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"
          git add stats.svg
          git commit -m "Atualizando Stats com repositórios privados"
          git push "https://${{ secrets.PAT }}@github.com/${{ github.repository_owner }}.git"
          echo "Repository owner: ${{ github.repository_owner }}"
